# Módulo 3, Aula 22: Callbacks

Um **callback** (função de retorno) é uma função que é passada como argumento para outra função, com a intenção de ser executada mais tarde.

Callbacks são a base do JavaScript assíncrono. Eles permitem que uma função execute uma tarefa e, quando essa tarefa estiver concluída, chame a função de callback para continuar a execução.

## Exemplo Síncrono de Callback

Mesmo em código síncrono, callbacks são muito comuns. Os métodos de array como `map`, `filter` e `forEach` todos usam callbacks.

```javascript
const numeros = [1, 2, 3];

// A função (n => n * 2) é um callback passado para o método map.
// O map executa esse callback para cada item do array.
const dobrados = numeros.map(n => n * 2);

console.log(dobrados); // Saída: [2, 4, 6]

function processarUsuario(nome, callback) {
  console.log(`Processando dados para: ${nome}`);
  // Após o processamento, executa o callback
  callback(nome.toUpperCase());
}

processarUsuario("Carlos", (nomeEmMaiusculas) => {
  console.log(`Nome processado: ${nomeEmMaiusculas}`);
});
// Saída:
// Processando dados para: Carlos
// Nome processado: CARLOS
```

## Callbacks em Código Assíncrono

A verdadeira força dos callbacks aparece em operações assíncronas, como ler um arquivo, fazer uma requisição de rede ou, no exemplo mais simples, usar `setTimeout`.

`setTimeout` é uma função que executa um callback após um determinado período de tempo.

```javascript
console.log("1. Início do processo.");

// A função de callback será executada após 2000ms (2 segundos).
setTimeout(() => {
  console.log("3. Callback executado após 2 segundos.");
}, 2000);

console.log("2. Fim do processo síncrono.");

// Ordem de execução no console:
// 1. Início do processo.
// 2. Fim do processo síncrono.
// (espera 2 segundos)
// 3. Callback executado após 2 segundos.
```
Isso demonstra a natureza não-bloqueante do JavaScript. O código não para e espera por 2 segundos; ele continua a execução e o callback é chamado quando o tempo se esgota.

## O "Callback Hell" (Inferno de Callbacks)

Quando você tem múltiplas operações assíncronas que dependem umas das outras, o uso de callbacks aninhados pode levar a um código difícil de ler e manter, conhecido como "Callback Hell" ou "Pyramid of Doom" (Pirâmide da Perdição).

```javascript
// Exemplo de Callback Hell
primeiraFuncao(args, (resultado1) => {
  segundaFuncao(resultado1, (resultado2) => {
    terceiraFuncao(resultado2, (resultado3) => {
      // E assim por diante...
      console.log("Finalmente, o resultado final!");
    });
  });
});
```
Este é um dos principais problemas que as **Promises** (próxima aula) vieram para resolver. Embora os callbacks ainda sejam amplamente utilizados, para sequências assíncronas complexas, as Promises e o `async/await` são abordagens muito superiores.

