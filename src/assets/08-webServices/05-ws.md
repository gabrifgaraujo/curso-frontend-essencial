# Aula 5: Enviando Dados (POST, PUT, DELETE)

## Objetivo
Objetivo: Aprender/Entender como enviar dados para uma API usando os métodos HTTP POST, PUT e DELETE com a Fetch API em JavaScript.

## O que é Envio de Dados para APIs?

Além de apenas buscar informações (com `GET`), a maioria das aplicações web precisa enviar dados para o servidor. Isso é fundamental para criar novos recursos (como um novo usuário ou post), atualizar recursos existentes ou excluí-los. A Fetch API nos permite fazer isso configurando o objeto de opções da requisição, especificando o método HTTP, os cabeçalhos e o corpo da requisição.

## Como funciona? Configurando Requisições POST, PUT e DELETE

Para enviar dados, precisamos configurar o segundo argumento da função `fetch()`, que é um objeto de opções. As propriedades mais importantes para envio de dados são:

*   `method`: O verbo HTTP (ex: `'POST'`, `'PUT'`, `'DELETE'`).
*   `headers`: Um objeto contendo os cabeçalhos da requisição. O mais comum é `'Content-Type': 'application/json'` para indicar que estamos enviando dados JSON.
*   `body`: Os dados que serão enviados. Para JSON, é necessário usar `JSON.stringify()` para converter o objeto JavaScript em uma string JSON.

### Exemplo Prático POST: Criando um Novo Recurso

Vamos criar um novo post na [JSONPlaceholder API](https://jsonplaceholder.typicode.com/).

```javascript
async function createPost() {
  const newPost = {
    title: 'Meu Novo Post Incrível',
    body: 'Este é o conteúdo do meu primeiro post usando a Fetch API.',
    userId: 1,
  };

  try {
    const response = await fetch('https://jsonplaceholder.typicode.com/posts', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json; charset=UTF-8',
      },
      body: JSON.stringify(newPost),
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json();
    console.log('Post criado com sucesso:', data);
    // A API JSONPlaceholder retorna o novo recurso com um ID gerado
  } catch (error) {
    console.error('Erro ao criar post:', error);
  }
}

createPost();
```

**Explicação:**
*   `method: 'POST'`: Indica que queremos criar um novo recurso.
*   `'Content-Type': 'application/json; charset=UTF-8'`: Informa ao servidor que o corpo da requisição é uma string JSON codificada em UTF-8.
*   `body: JSON.stringify(newPost)`: Converte o objeto JavaScript `newPost` em uma string JSON para ser enviada no corpo da requisição.

### Exemplo Prático PUT: Atualizando um Recurso Existente

Para atualizar um post existente (digamos, o post com ID 1), usamos o método `PUT`. Geralmente, `PUT` espera a representação completa do recurso a ser atualizado.

```javascript
async function updatePost() {
  const postId = 1;
  const updatedPost = {
    id: postId, // É uma boa prática incluir o ID no corpo para PUT
    title: 'Título do Post Atualizado',
    body: 'Conteúdo do post foi completamente modificado.',
    userId: 1,
  };

  try {
    const response = await fetch(`https://jsonplaceholder.typicode.com/posts/${postId}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json; charset=UTF-8',
      },
      body: JSON.stringify(updatedPost),
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json();
    console.log('Post atualizado com sucesso:', data);
  } catch (error) {
    console.error('Erro ao atualizar post:', error);
  }
}

updatePost();
```

**Explicação:**
*   `method: 'PUT'`: Indica que queremos substituir um recurso existente.
*   A URL inclui o ID do recurso a ser atualizado (`/posts/${postId}`).
*   O `body` contém a representação completa e atualizada do recurso.

### Exemplo Prático DELETE: Excluindo um Recurso

Para excluir um post, usamos o método `DELETE`. Requisições `DELETE` geralmente não precisam de um corpo.

```javascript
async function deletePost() {
  const postId = 1;

  try {
    const response = await fetch(`https://jsonplaceholder.typicode.com/posts/${postId}`, {
      method: 'DELETE',
    });

    // DELETE geralmente retorna um status 200 OK ou 204 No Content se bem-sucedido
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    console.log(`Post ${postId} excluído com sucesso.`);
    // Para DELETE, response.json() pode falhar se não houver corpo na resposta (204 No Content)
    // Portanto, é mais seguro não tentar parsear JSON se o status for 204.
    if (response.status !== 204) {
        const data = await response.json();
        console.log('Resposta do DELETE (se houver):', data);
    }

  } catch (error) {
    console.error('Erro ao excluir post:', error);
  }
}

deletePost();
```

**Explicação:**
*   `method: 'DELETE'`: Indica que queremos remover um recurso.
*   A URL inclui o ID do recurso a ser excluído.
*   Não há `body` na requisição `DELETE`.
*   Verificamos `response.status !== 204` antes de tentar `response.json()` para evitar erros se o servidor não retornar conteúdo.

Dominar esses métodos HTTP e a configuração da Fetch API é fundamental para construir aplicações web interativas que se comunicam de forma eficaz com APIs.
